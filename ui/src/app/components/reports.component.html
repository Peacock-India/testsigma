<div class="page-header theme-border-b pl-0 plugins-list ml-14">
<ul class="tab-nav" role="tablist">
  <li class="nav-items" role="presentation">
    <a
      class="normal-text"
      [routerLinkActive]="'active'"
      [routerLink]="['./analytics']">
      <span [translate]="'Analytics'" ></span>
    </a>
  </li>
  <li class="nav-items" role="presentation">
    <a
      [routerLinkActive]="'active'"
      [routerLink]="['./custom_reports']"
      (click)="goToPage('custom_reports')"
      class="normal-text">
      <span [translate]="'Reports'"></span>
    </a>
  </li>
  <li class="nav-items" role="presentation">
    <a
      [routerLinkActive]="'active'"
      [routerLink]="['./query_engine']"
      class="normal-text">
      <span [translate]="'Query Engine'"></span>
    </a>
  </li>
</ul>
<div class="ml-auto">
  <button
    class="theme-btn-primary"
    (click)="exportInsights()"
    >
    Download Insights
  </button>
</div>
</div>
  <div *ngIf="this.router.url.indexOf('analytics')!=-1">
  <div class="page-content page-virtual-scroll pt-40 ml-20 d-flex-wrap" >
    <div>
      <div class="highChart" id="topFailuresChart" *ngIf="this.router.url.indexOf('analytics')!=-1">
        <highcharts-chart style="width: 100%; height: 400px; display:block"
          [Highcharts] = "Highcharts"
          [options] = "topFailuresChartOptions">
        </highcharts-chart>
        </div>
    </div>

    <div>
      <div class="highChart" id="lingeredTestsChart">
        <highcharts-chart
          [Highcharts] = "Highcharts"
          [options] = "lingeredTestsChartOptions">
        </highcharts-chart>
      </div>
    </div>

    <div>
      <div class="highChart" id="runDurationTrendChart">
        <highcharts-chart
          [Highcharts] = "Highcharts"
          [options] = "runDurationTrendChartOptions">
        </highcharts-chart>
      </div>
    </div>

    <div>
      <div class="highChart" id="flakyTestsChart">
        <highcharts-chart  style="width: 100%; height: 400px; display: block;"
          [Highcharts] = "Highcharts"
          [options] = "flakyTestsChartOptions">
        </highcharts-chart>
      </div>
    </div>

  </div>
    </div>
  <div *ngIf="this.router.url.indexOf('query_engine')!=-1">
    <div class="page-content page-virtual-scroll pt-40 d-flex-wrap" >
      <form
        class="ts-form create-form-full-view w-75 px-0"
        [formGroup]="queryReportsForm">
        <div class="px-0">
          <div class="content-view">
            <div class="d-flex">
              <a
                class="form-title"
                [translate]="'QUERY REPORTS'"></a>
            </div>
            <div
              class="create-form-title mb-8 pt-30"
              [translate]="'Enter Report Name'"></div>
            <div class="form-group pb-14 ml-auto">
              <input
                class="form-control"
                required
                name="name"
                formControlName="name"
                autofocus/>
            </div>
            <div class="form-group">
              <mat-form-field appearance="fill">
                <mat-label>Module</mat-label>
                <mat-select formControlName="module">
                  <mat-option *ngFor="let module of modules" [value]="module.name">
                    {{module.name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div class="form-group">
              <div
                class="mt-15">
               <textarea
                 class="form-control resize-none"
                 name="byValue"
                 [placeholder]="'enter query here'"
                 [formControlName]="['description']"
                 rows="4"></textarea>
              </div>
            </div>


            </div>
          </div>
        <div class="theme-overlay-footer mb-10">
      <button
        class="theme-btn-primary"
        appAsyncBtn
        [message]="'message.common.saving'"
        [textContent]="'Run'"
        (click)="getQueryReport()">
      </button>
        </div>
      </form>
      <div *ngIf="showTable">
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 demo-table">
        <ng-container *ngFor="let column of columns" [matColumnDef]="column.columnDef">
          <th mat-header-cell *matHeaderCellDef>
            {{column.header}}
          </th>
          <td mat-cell *matCellDef="let row">
            {{column.cell(row)}}
          </td>
        </ng-container>

      </table>
      </div>

    </div>
  </div>
  <div *ngIf="this.router.url.indexOf('custom_reports')!=-1">
    <div class="page-content page-virtual-scroll pt-40 d-flex-wrap" >
      <div class="page-header">
        <div
          class="page-title"
          [translate]="'Custom Reports'">
        </div>

        <div class="short-hand-actions">
          <button
            [matTooltip]="'Create'"
            (click)="openCreateForm()"
            class="theme-btn-primary border-rds-2 ml-44" style="margin-right: 50px !important;">
            <span [translate]="'Create'"></span>
          </button>
          <div class=" ml-15 pl-15 theme-border-l">
            <app-pagination></app-pagination>
          </div>
        </div>
      </div>

      <div class="page-content" style="overflow-y: visible;padding-top: 55px;">
        <div
          class="list-header ts-col-100">
          <div
            class="ts-col-100 d-flex">
      <span
        class="ts-col-25" [translate]="'Report Name'"></span>
            <span
              class="ts-col-25" [translate]="'Description'"></span>
            <span
              class="ts-col-25 ts-col-15 mx-30" [translate]="'Type'"></span>
          </div>
        </div>
        <div class="list-container ts-col-100 without-title-height">
          <a
            class="list-view green-highlight lg-pm text-t-secondary d-flex ts-col-100 text-break"
            *ngFor='let report of reportsList?.content'
            >
          <span
            class="ts-col-25 list-title"
            (click)="openReport(report?.id)"
            [textContent]="report?.name"
            ></span>
            <span
              class="ts-col-25 list-title"
              [textContent]="report?.description"
              ></span>
            <span
              class="ts-col-15 list-title"
              [textContent]="report?.reportType"
              ></span>
            <div class="ts-col-5" >
              <a
                [matTooltip]="'Export As PDF' | translate"
                target="_blank"
                class="fa-download-thin text-dark"></a>
              <a
                [matTooltip]="'Schedule' | translate"
                target="_blank"
                class="fa-calendar text-dark pl-15"></a>
            </div>
          </a>

        </div>
      </div>

    </div>

    </div>
